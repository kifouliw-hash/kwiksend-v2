<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KwikSend - Recevoir un paiement</title>
<meta name="description" content="G√©n√©rez un lien de paiement pour recevoir de l'argent avec KwikSend.">
<meta name="theme-color" content="#ff7a00">
<!-- Favicon & ic√¥nes -->
<link rel="icon" type="image/x-icon" href="favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<!-- Manifest PWA -->
<link rel="manifest" href="site.webmanifest">
<!-- Styles -->
<link rel="stylesheet" href="style.css">
<style>
.payment-card {
    background: white;
    border-radius: 20px;
    padding: 2rem;
    max-width: 450px;
    margin: 2rem auto;
    box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    text-align: center;
}

.payment-header {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    margin-bottom: 2rem;
    font-size: 1.5rem;
    font-weight: 600;
}

.payment-header .icon {
    font-size: 2rem;
}

.payment-header .title-orange {
    color: #ff7a00;
}

.payment-header .title-green {
    color: #4caf50;
}

.qr-container {
    background: white;
    padding: 1.5rem;
    border-radius: 15px;
    display: inline-block;
    margin-bottom: 2rem;
}

#qrcode {
    width: 250px;
    height: 250px;
}

.amount-display {
    background: #fff5eb;
    border: 2px solid #ff7a00;
    border-radius: 15px;
    padding: 1.5rem;
    margin-bottom: 2rem;
}

.amount-label {
    color: #999;
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
}

.amount-value {
    color: #ff7a00;
    font-size: 2.5rem;
    font-weight: bold;
}

.payment-link {
    background: #f5f5f5;
    border: 2px solid #e0e0e0;
    border-radius: 10px;
    padding: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
    font-size: 0.85rem;
    color: #666;
    word-break: break-all;
}

.copy-btn {
    background: #ff7a00;
    color: white;
    border: none;
    padding: 0.7rem 1rem;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1.2rem;
    flex-shrink: 0;
    transition: all 0.3s;
}

.copy-btn:hover {
    background: #e66900;
    transform: scale(1.05);
}

.share-buttons {
    display: flex;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.share-btn {
    flex: 1;
    padding: 1rem;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-weight: 600;
    font-size: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    transition: all 0.3s;
}

.whatsapp-btn {
    background: #25d366;
    color: white;
}

.whatsapp-btn:hover {
    background: #1fb855;
    transform: translateY(-2px);
}

.email-btn {
    background: #ea4335;
    color: white;
}

.email-btn:hover {
    background: #d33426;
    transform: translateY(-2px);
}

.close-btn {
    background: #f5f5f5;
    color: #666;
    border: none;
    padding: 1rem;
    border-radius: 10px;
    cursor: pointer;
    font-weight: 600;
    font-size: 1rem;
    width: 100%;
    transition: all 0.3s;
}

.close-btn:hover {
    background: #e0e0e0;
}

.amount-input-section {
    margin-bottom: 2rem;
}

.amount-input-section label {
    display: block;
    text-align: left;
    margin-bottom: 0.5rem;
    color: #333;
    font-weight: 500;
}

.amount-input-section input {
    width: 100%;
    padding: 1rem;
    border: 2px solid #e0e0e0;
    border-radius: 10px;
    font-size: 1.2rem;
    text-align: center;
}

.generate-btn {
    background: #ff7a00;
    color: white;
    border: none;
    padding: 1rem 2rem;
    border-radius: 10px;
    cursor: pointer;
    font-weight: 600;
    font-size: 1.1rem;
    width: 100%;
    transition: all 0.3s;
}

.generate-btn:hover {
    background: #e66900;
    transform: translateY(-2px);
}

.hidden {
    display: none;
}

@media (max-width: 768px) {
    .payment-card {
        margin: 1rem;
        padding: 1.5rem;
    }
    
    #qrcode {
        width: 200px;
        height: 200px;
    }
    
    .amount-value {
        font-size: 2rem;
    }
}
</style>
</head>
<body>
<!-- üß≠ Header -->
<header>
<div class="container header-container">
<div class="logo">Kwik<span>Send</span></div>
<nav>
<ul class="nav-links">
<li><a href="index.html" data-i18n="nav.home">Accueil</a></li>
<li><a href="index.html#fonctionnalites" data-i18n="nav.features">Fonctionnalit√©s</a></li>
<li><a href="index.html#avantages" data-i18n="nav.advantages">Avantages</a></li>
<li><a href="portefeuille.html" data-i18n="nav.wallet">Portefeuille</a></li>
<li><a href="connexion.html" class="cta-nav" data-i18n="nav.login">Connexion</a></li>
</ul>
</nav>
<div class="header-actions">
<select id="langSwitcher" onchange="switchLang(this.value)">
<option value="fr">üá´üá∑ FR</option>
<option value="en">üá¨üáß EN</option>
</select>
<button id="darkToggle">üåô</button>
</div>
</div>
</header>

<!-- üí∞ Section Recevoir -->
<section class="hero" style="padding:2rem 1rem; min-height: 80vh;">
<!-- Formulaire de saisie du montant -->
<div id="amountForm" class="payment-card">
<div class="payment-header">
<span class="icon">üí∞</span>
<span>Recevoir de l'argent</span>
</div>
<p style="color: #666; margin-bottom: 2rem;">Saisissez le montant que vous souhaitez recevoir</p>
<div class="amount-input-section">
<label for="receiveAmount">Montant (EUR) :</label>
<input type="number" id="receiveAmount" placeholder="Ex: 50" min="1" required>
</div>
<button class="generate-btn" onclick="generatePayment()">
G√©n√©rer le lien de paiement
</button>
</div>

<!-- Carte de paiement g√©n√©r√©e (cach√©e au d√©part) -->
<div id="paymentCard" class="payment-card hidden">
<div class="payment-header">
<span class="icon">üì¶</span>
<span class="title-orange">Paiement</span>
<span class="title-green">g√©n√©r√©</span>
</div>

<!-- QR Code -->
<div class="qr-container">
<div id="qrcode"></div>
</div>

<!-- Montant -->
<div class="amount-display">
<div class="amount-label">Montant</div>
<div class="amount-value" id="displayAmount">50 ‚Ç¨</div>
</div>

<!-- Lien de paiement -->
<div class="payment-link">
<span id="paymentLinkText">https://kwiksend.com/pay/kifoull?amount=50</span>
<button class="copy-btn" onclick="copyLink()" title="Copier le lien">
üìã
</button>
</div>

<!-- Boutons de partage -->
<div class="share-buttons">
<button class="share-btn whatsapp-btn" onclick="shareWhatsApp()">
üì± WhatsApp
</button>
<button class="share-btn email-btn" onclick="shareEmail()">
üìß Email
</button>
</div>

<!-- Bouton fermer -->
<button class="close-btn" onclick="closePayment()">
Fermer
</button>
</div>
</section>

<!-- üìù Footer -->
<footer>
<p>¬© 2025 KwikSend. <span data-i18n="footer.rights">Tous droits r√©serv√©s.</span></p>
</footer>

<!-- QR Code Library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<!-- üìú Scripts communs -->
<script src="script.js"></script>
<script src="translate.js"></script>
<script src="app.js"></script>

<!-- üì≤ Logique de g√©n√©ration de paiement -->
<script>
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js').catch(console.error);
}

let currentAmount = 0;
let paymentLink = '';
let qrCodeInstance = null;

function generatePayment() {
    const amountInput = document.getElementById('receiveAmount');
    const amount = parseFloat(amountInput.value);
    
    if (isNaN(amount) || amount <= 0) {
        alert('‚ö†Ô∏è Veuillez entrer un montant valide.');
        return;
    }
    
    currentAmount = amount;
    
    // R√©cup√©rer l'ID utilisateur (√† adapter selon votre syst√®me)
    const userId = localStorage.getItem('userId') || 'kifoull';
    
    // G√©n√©rer le lien de paiement
    paymentLink = `https://kwiksend.com/pay/${userId}?amount=${amount}`;
    
    // Afficher le montant
    document.getElementById('displayAmount').textContent = `${amount} ‚Ç¨`;
    
    // Afficher le lien
    document.getElementById('paymentLinkText').textContent = paymentLink;
    
    // G√©n√©rer le QR code
    document.getElementById('qrcode').innerHTML = '';
    qrCodeInstance = new QRCode(document.getElementById('qrcode'), {
        text: paymentLink,
        width: 250,
        height: 250,
        colorDark: '#ff7a00',
        colorLight: '#ffffff',
        correctLevel: QRCode.CorrectLevel.H
    });
    
    // Masquer le formulaire et afficher la carte
    document.getElementById('amountForm').classList.add('hidden');
    document.getElementById('paymentCard').classList.remove('hidden');
}

function copyLink() {
    navigator.clipboard.writeText(paymentLink).then(() => {
        const btn = event.target;
        const originalText = btn.textContent;
        btn.textContent = '‚úÖ';
        btn.style.background = '#4caf50';
        
        setTimeout(() => {
            btn.textContent = originalText;
            btn.style.background = '#ff7a00';
        }, 2000);
    }).catch(err => {
        alert('‚ùå Erreur lors de la copie du lien');
    });
}

function shareWhatsApp() {
    const message = `Bonjour ! Merci de me payer ${currentAmount} ‚Ç¨ via ce lien : ${paymentLink}`;
    const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
    window.open(whatsappUrl, '_blank');
}

function shareEmail() {
    const subject = 'Demande de paiement KwikSend';
    const body = `Bonjour,\n\nMerci de me payer ${currentAmount} ‚Ç¨ via ce lien :\n${paymentLink}\n\nCordialement`;
    const mailtoUrl = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
    window.location.href = mailtoUrl;
}

function closePayment() {
    document.getElementById('paymentCard').classList.add('hidden');
    document.getElementById('amountForm').classList.remove('hidden');
    document.getElementById('receiveAmount').value = '';
}
</script>
</body>
</html>